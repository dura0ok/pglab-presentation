<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–î–æ–∫–ª–∞–¥ Postgres-Pro –î—É—Ä–∞—á–æ–∫ –ì–ª—É–ø—ã–π</title>
    <link rel="stylesheet" href="dist/reset.css">
    <link rel="stylesheet" href="dist/reveal.css">
    <link rel="stylesheet" href="dist/theme/black.css">
    <link rel="stylesheet" href="plugin/highlight/monokai.css">
</head>

<body>
    <div class="reveal">
        <div class="slides">
            <section>
                <h1 class="r-fit-text">–≠–º—É–ª—è—Ü–∏—è —Å–±–æ–µ–≤ —Ñ–∞–π–ª–æ–≤—ã—Ö —Å–∏—Å—Ç–µ–º</h1>
                <img src="images/mem5.png" alt="">
                <aside class="notes">
                    Shhh, these are your private notes üìù
                </aside>
            </section>
            <section>
                <h2 class="r-fit-text">–ö—Ä–∞—Ç–∫–æ –æ —Ç–æ–º –∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ñ–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞</h2>
                <img src="images/mem10.jpg" alt="">
            </section>
            <section>
                <img src="images/file-structure.webp" alt="">
            </section>
            <section data-background-color="white">
                –î–∏–∑–∞–π–Ω —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã
                <img src="images/fs-design.png" alt="">
                <aside class="notes">
                    <p>–ü–µ—Ä–≤—ã–π –±–ª–æ–∫ –¥–∏—Å–∫–∞ - —ç—Ç–æ —Å—É–ø–µ—Ä–±–ª–æ–∫, –∫–æ—Ç–æ—Ä—ã–π –æ–ø–∏—Å—ã–≤–∞–µ—Ç —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ –æ—Å—Ç–∞–ª—å–Ω–æ–π —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–ª–æ–∫–æ–≤, —Å–ª–µ–¥—É—é—â–∏—Ö –∑–∞ —Å—É–ø–µ—Ä–±–ª–æ–∫–æ–º, —Å–æ–¥–µ—Ä–∂–∞—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö inode. –ö–∞–∫ –ø—Ä–∞–≤–∏–ª–æ, –¥–µ—Å—è—Ç—å –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤ –æ—Ç –æ–±—â–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –¥–∏—Å–∫–æ–≤—ã—Ö –±–ª–æ–∫–æ–≤ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ –∫–∞—á–µ—Å—Ç–≤–µ –±–ª–æ–∫–æ–≤ inode. –û—Å—Ç–∞–ª—å–Ω—ã–µ –±–ª–æ–∫–∏ –≤ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∫–∞–∫ –æ–±—ã—á–Ω—ã–µ –±–ª–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö</p>
                    <p>–≠—Ç–æ—Ç —Å—É–ø–µ—Ä–±–ª–æ–∫ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ —á–µ—Ç—ã—Ä–µ—Ö –ø–æ–ª–µ–π:</p>
                    <ol>
                        <li>
                            <strong>MAGIC_NUMBER</strong> –∏–ª–∏ 0xf0f03410. –ü—Ä–æ—Ü–µ–¥—É—Ä–∞ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ–º–µ—â–∞–µ—Ç —ç—Ç–æ —á–∏—Å–ª–æ –≤ —Å–∞–º—ã–µ –ø–µ—Ä–≤—ã–µ –±–∞–π—Ç—ã —Å—É–ø–µ—Ä–±–ª–æ–∫–∞ –∫–∞–∫ —Å–≤–æ–µ–≥–æ —Ä–æ–¥–∞ "–ø–æ–¥–ø–∏—Å—å" —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã. –ö–æ–≥–¥–∞ —Ñ–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ —Å–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∞, –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∏—â–µ—Ç —ç—Ç–æ –º–∞–≥–∏—á–µ—Å–∫–æ–µ —á–∏—Å–ª–æ. –ï—Å–ª–∏ –æ–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ, —Ç–æ –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç—Å—è, —á—Ç–æ –¥–∏—Å–∫ —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–æ–ø—É—Å—Ç–∏–º—É—é —Ñ–∞–π–ª–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É. –ï—Å–ª–∏ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∫–∞–∫–æ–µ-–ª–∏–±–æ –¥—Ä—É–≥–æ–µ —á–∏—Å–ª–æ, —Ç–æ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è –Ω–µ—É–¥–∞—á–Ω–æ, –≤–æ–∑–º–æ–∂–Ω–æ, –ø–æ—Ç–æ–º—É, —á—Ç–æ –¥–∏—Å–∫ –Ω–µ –æ—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω –∏–ª–∏ —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–∞–∫–∏–µ-–ª–∏–±–æ –¥—Ä—É–≥–∏–µ –¥–∞–Ω–Ω—ã–µ.
                        </li>
                        <li><strong>–ë–ª–æ–∫–∏:</strong> –í—Ç–æ—Ä–æ–µ –ø–æ–ª–µ - —ç—Ç–æ –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–ª–æ–∫–æ–≤, –∫–æ—Ç–æ—Ä–æ–µ –¥–æ–ª–∂–Ω–æ —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –±–ª–æ–∫–æ–≤ –Ω–∞ –¥–∏—Å–∫–µ.</li>
                        <li><strong>InodeBlocks:</strong> –¢—Ä–µ—Ç—å–µ –ø–æ–ª–µ - —ç—Ç–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–ª–æ–∫–æ–≤, –æ—Ç–≤–µ–¥–µ–Ω–Ω—ã—Ö –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–Ω–¥–µ–∫—Å–Ω—ã—Ö –∏–Ω–¥–µ–∫—Å–æ–≤. –ü—Ä–æ—Ü–µ–¥—É—Ä–∞ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –≤—ã–±–æ—Ä —ç—Ç–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä–æ–µ –≤—Å–µ–≥–¥–∞ –¥–æ–ª–∂–Ω–æ —Å–æ—Å—Ç–∞–≤–ª—è—Ç—å 10% –æ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –±–ª–æ–∫–æ–≤ —Å –æ–∫—Ä—É–≥–ª–µ–Ω–∏–µ–º –≤ –±–æ–ª—å—à—É—é —Å—Ç–æ—Ä–æ–Ω—É.</li>
                        <li><strong>–ò–Ω–¥–µ–∫—Å—ã:</strong> –ß–µ—Ç–≤–µ—Ä—Ç–æ–µ –ø–æ–ª–µ - —ç—Ç–æ –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–Ω–¥–µ–∫—Å–æ–≤ –≤ —ç—Ç–∏—Ö –±–ª–æ–∫–∞—Ö –∏–Ω–¥–µ–∫—Å–æ–≤.</li>
                    </ol>
                    <p>–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö —Å—É–ø–µ—Ä–±–ª–æ–∫–∞ –¥–æ–≤–æ–ª—å–Ω–æ –º–∞–ª–∞: –≤—Å–µ–≥–æ 16 –±–∞–π—Ç. –û—Å—Ç–∞–≤—à–∞—è—Å—è —á–∞—Å—Ç—å –Ω—É–ª–µ–≤–æ–≥–æ –¥–∏—Å–∫–æ–≤–æ–≥–æ –±–ª–æ–∫–∞ –æ—Å—Ç–∞–µ—Ç—Å—è –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–π.</p>
                </aside>
            </section>
            <section data-background-color="white">
                –î–∏–∑–∞–π–Ω INode
                <img src="images/inode-design.jpg" alt="">
            </section>
            <section data-background-color="white">
                <img src="images/hard-links.png" alt="">
            </section>
            <section data-background-color="white">
                <h1 class="r-fit-text">–ß—Ç–æ –º–æ–∂–µ–º —Å–∏–º—É–ª–∏—Ä–æ–≤–∞—Ç—å?</h1>
                <ul>
                    <li>–ó–∞–∫–æ–Ω—á–∏–ª–∏—Å—å inode ü™π</li>
                    <li>–û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è ‚ùå</li>
                    <li>–ó–∞–º–µ–¥–ª–µ–Ω–∏–µ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π üê¢ ü¶•</li>
                    <li>–ü–æ—Å–ª–∞—Ç—å SIGKILL –≤ –æ—Ç–≤–µ—Ç ü§°</li>
                </ul>
            </section>
            <section>
                <table>
                    <thead>
                        <tr>
                            <th>–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç</th>
                            <th>–°—Å—ã–ª–∫–∞/–ö–æ–º–º–µ–Ω–∞—Ç–∞—Ä–∏–π</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>CharybdeFS</td>
                            <td><a href="https://github.com/scylladb/charybdefs">github</a></td>
                        </tr>
                        <tr>
                            <td>PetardFS</td>
                            <td><a href="https://github.com/jrandall/petardfs">github</a></td>
                        </tr>
                        <tr>
                            <td>UnreliableFS</td>
                            <td><a href="https://github.com/ligurio/unreliablefs">github</a></td>
                        </tr>
                        <tr>
                            <td>libeatmydata</td>
                            <td><a href="https://github.com/stewartsmith/libeatmydata">github</a></td>
                        </tr>
                    </tbody>
                </table>
            </section>

            <section>
                <table>
                    <thead>
                        <tr>
                            <th>–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç</th>
                            <th>–°—Å—ã–ª–∫–∞/–ö–æ–º–º–µ–Ω–∞—Ç–∞—Ä–∏–π</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>cleancache</td>
                            <td><a href="https://github.com/kahing/bin/blob/master/cleancache.c">github</a></td>
                        </tr>
                        <tr>
                            <td>Device Mapper</td>
                            <td><a href="https://www.kernel.org/doc/Documentation/device-mapper/dm-flakey.txt">Kernel docs</a></td>
                        </tr>
                        <tr>
                            <td>QEMU</td>
                            <td><a href="https://github.com/qemu/qemu/blob/master/docs/devel/blkdebug.txt">github</a></td>
                        </tr>
                        <tr>
                            <td>sysrq</td>
                            <td><a href="https://www.kernel.org/doc/html/latest/admin-guide/sysrq.html">github</a></td>
                        </tr>
                    </tbody>
                </table>
            </section>

            <section>
                <table>
                    <thead>
                        <tr>
                            <th>–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç</th>
                            <th>–°—Å—ã–ª–∫–∞/–ö–æ–º–º–µ–Ω–∞—Ç–∞—Ä–∏–π</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Linux kernel fault injection capabilities infrastructure</td>
                            <td><a href="https://www.kernel.org/doc/html/latest/fault-injection/fault-injection.html">Kernel docs</a></td>
                        </tr>
                        <tr>
                            <td>libfiu</td>
                            <td><a href="http://blitiri.com.ar/p/libfiu/">Link</a></td>
                        </tr>
                        <tr>
                            <td>Linux kernel notifier fault injection</td>
                            <td><a href="https://www.kernel.org/doc/html/latest/fault-injection/notifier-error-inject.html">github</a></td>
                        </tr>
                        <tr>
                            <td>BSOD</td>
                            <td><a href=" https://docs.microsoft.com/en-us/windows-hardware/drivers/debugger/forcing-a-system-crash-from-the-keyboard">github</a></td>
                        </tr>
                    </tbody>
                </table>
            </section>  

            <section>
                <img src="images/fault-tools.png" alt="">
            </section>

            <section>
                <h1 class="r-fit-text">–ü—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä —Ä–∞–±–æ—Ç—ã UnreliableFS</h1>
                <img src="images/mem4.png" alt="">
            </section>

            <section>
                <h1 class="r-fit-text">–£—Å—Ç–∞–Ω–æ–≤–∫–∞ UnreliableFS</h1>
                <pre><code data-trim data-noescape>
                    $ git clone git@github.com:ligurio/unreliablefs.git
                    $ cmake -S . -B build -DCMAKE_BUILD_TYPE=Debug
                    $ cmake --build build --parallel
                    $ mkdir mntpoint bsdir
                    $ cat << EOF > /tmp/fs/unreliablefs.conf
                    [errinj_noop]
                    op_regexp = read
                    path_regexp = .*
                    probability = 30
                    EOF
                    $ ./unreliablefs mntpoint -basedir=bsdir -seed=1618680646 -f
                </code></pre>
            </section>
            <section>
                <h1 class="r-fit-text">–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã UnreliableFS</h1>
                <img src="images/example-simple-work.png" alt="">
            </section>
            <section>
                <h1 class="r-fit-text">–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ <a href="https://ligurio.github.io/unreliablefs/unreliablefs.1.html">–æ–ø–µ—Ä–∞—Ü–∏–∏</a> –¥–ª—è –∏–Ω—å–µ–∫—Ü–∏–∏–∏ UnreliableFS</h1>
                <img src="images/supported-options.png" alt="">
            </section>
            <section>
                <h2 class="r-fit-text">FUSE - FileSystem in <b>USER</b> space</h2>
                <img src="images/fuse.jpg" alt="">
            </section>
            <section>
                <h2 class="r-fit-text">–ü–æ–¥–Ω–∏–º–∞–µ–º —Å–≤–æ–π Fuse –Ω–∞ –∫–æ–ª–µ–Ω–∫–∞—Ö</h2>
                <pre><code data-line-numbers="21-28|30-40|1-88|" data-trim data-noescape style="font-size: 15px;">
#!/usr/bin/env python

import os
import sys
import random
from fuse import FUSE, FuseOSError, Operations

class SimpleFS(Operations):
    def __init__(self, basedir):
        self.basedir = basedir

    def getattr(self, path, fh=None):
        full_path = self._full_path(path)
        try:
            st = os.lstat(full_path)
            return dict((key, getattr(st, key)) for key in ('st_atime', 'st_ctime',
                         'st_gid', 'st_mode', 'st_mtime', 'st_nlink', 'st_size', 'st_uid'))
        except FileNotFoundError:
            raise FuseOSError(2) 

    def readdir(self, path, fh):
        full_path = self._full_path(path)
        try:
            dirents = ['.', '..'] + [f.name for f in os.scandir(full_path)]
            for r in dirents:
                yield r
        except FileNotFoundError:
            raise FuseOSError(2) 

    def read(self, path, size, offset, fh):
        full_path = self._full_path(path)
        try:
            with open(full_path, 'rb') as f:
                data = f.read()
                # 50% probability of no-op
                if random.random() < 0.5:
                    return b''  # Return empty data as a no-op
                return data[offset:offset + size]
        except FileNotFoundError:
            raise FuseOSError(2)  
    def write(self, path, data, offset, fh):
        full_path = self._full_path(path)
        try:
            with open(full_path, 'r+b') as f:
                f.seek(offset)
                f.write(data)
                return len(data)
        except FileNotFoundError:
            raise FuseOSError(2) 

    def mkdir(self, path, mode):
        full_path = self._full_path(path)
        try:
            os.mkdir(full_path, mode)
        except FileExistsError:
            raise FuseOSError(17) 
        except FileNotFoundError:
            raise FuseOSError(2) 

    def rmdir(self, path):
        full_path = self._full_path(path)
        try:
            os.rmdir(full_path)
        except FileNotFoundError:
            raise FuseOSError(2) 

    def unlink(self, path):
        full_path = self._full_path(path)
        try:
            os.unlink(full_path)
        except FileNotFoundError:
            raise FuseOSError(2) 

    def _full_path(self, partial):
        if partial.startswith("/"):
            partial = partial[1:]
        path = os.path.join(self.basedir, partial)
        return path

if __name__ == '__main__':
    if len(sys.argv) != 3:
        print("Usage: {} mountpoint basedir".format(sys.argv[0]))
        sys.exit(1)

    mountpoint = sys.argv[1]
    basedir = sys.argv[2]

    fuse = FUSE(SimpleFS(basedir), mountpoint, foreground=True)

                </code></pre>
            </section>
            <section>
                <p>–ó–∞–ø—É—Å—Ç–∏–º –Ω–∞—à—É —Ñ–∞–π–ª—É—Ö—É</p>
                <img src="images/custom-fuse-python-working.png" alt="">
            </section>
            <section>
                <p>–î–æ–±–∞–≤–∏–º –≤—Å–µ –º–µ—Ç–æ–¥—ã –∏ —á—É—Ç—å –æ—Ç—Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–º</p>
                <pre><code data-line-numbers="" data-trim data-noescape style="font-size: 15px;">
#!/usr/bin/env python

from __future__ import with_statement

import os
import sys
import random
import errno

from fuse import FUSE, FuseOSError, Operations, fuse_get_context


class Passthrough(Operations):
    def __init__(self, root):
        self.root = root

    # Helpers
    # =======

    def _full_path(self, partial):
        if partial.startswith("/"):
            partial = partial[1:]
        path = os.path.join(self.root, partial)
        return path

    # Filesystem methods
    # ==================

    def access(self, path, mode):
        full_path = self._full_path(path)
        if not os.access(full_path, mode):
            raise FuseOSError(errno.EACCES)

    def chmod(self, path, mode):
        full_path = self._full_path(path)
        return os.chmod(full_path, mode)

    def chown(self, path, uid, gid):
        full_path = self._full_path(path)
        return os.chown(full_path, uid, gid)

    def getattr(self, path, fh=None):
        full_path = self._full_path(path)
        st = os.lstat(full_path)
        return dict((key, getattr(st, key)) for key in ('st_atime', 'st_ctime',
                     'st_gid', 'st_mode', 'st_mtime', 'st_nlink', 'st_size', 'st_uid'))

    def readdir(self, path, fh):
        full_path = self._full_path(path)

        dirents = ['.', '..']
        if os.path.isdir(full_path):
            dirents.extend(os.listdir(full_path))
        for r in dirents:
            yield r

    def readlink(self, path):
        pathname = os.readlink(self._full_path(path))
        if pathname.startswith("/"):
            # Path name is absolute, sanitize it.
            return os.path.relpath(pathname, self.root)
        else:
            return pathname

    def mknod(self, path, mode, dev):
        return os.mknod(self._full_path(path), mode, dev)

    def rmdir(self, path):
        full_path = self._full_path(path)
        return os.rmdir(full_path)

    def mkdir(self, path, mode):
        return os.mkdir(self._full_path(path), mode)

    def statfs(self, path):
        full_path = self._full_path(path)
        stv = os.statvfs(full_path)
        return dict((key, getattr(stv, key)) for key in ('f_bavail', 'f_bfree',
            'f_blocks', 'f_bsize', 'f_favail', 'f_ffree', 'f_files', 'f_flag',
            'f_frsize', 'f_namemax'))

    def unlink(self, path):
        return os.unlink(self._full_path(path))

    def symlink(self, name, target):
        return os.symlink(target, self._full_path(name))

    def rename(self, old, new):
        return os.rename(self._full_path(old), self._full_path(new))

    def link(self, target, name):
        return os.link(self._full_path(name), self._full_path(target))

    def utimens(self, path, times=None):
        return os.utime(self._full_path(path), times)

    # File methods
    # ============

    def open(self, path, flags):
        full_path = self._full_path(path)
        return os.open(full_path, flags)

    def create(self, path, mode, fi=None):
        uid, gid, pid = fuse_get_context()
        full_path = self._full_path(path)
        fd = os.open(full_path, os.O_WRONLY | os.O_CREAT, mode)
        os.chown(full_path,uid,gid) #chown to context uid & gid
        return fd

    def read(self, path, length, offset, fh):
        # Add a read no-op operation with 50% probability
        if random.random() < 0.5:
            return b''  # Return an empty byte string as a no-op
        else:
            os.lseek(fh, offset, os.SEEK_SET)
            return os.read(fh, length)

    def write(self, path, buf, offset, fh):
        os.lseek(fh, offset, os.SEEK_SET)
        return os.write(fh, buf)

    def truncate(self, path, length, fh=None):
        full_path = self._full_path(path)
        with open(full_path, 'r+') as f:
            f.truncate(length)

    def flush(self, path, fh):
        return os.fsync(fh)

    def release(self, path, fh):
        return os.close(fh)

    def fsync(self, path, fdatasync, fh):
        return self.flush(path, fh)


def main(mountpoint, root):
    FUSE(Passthrough(root), mountpoint, nothreads=True, foreground=True, allow_other=True)


if __name__ == '__main__':
    main(sys.argv[2], sys.argv[1])

                </code></pre>
            </section>
            <section>
                <h1 class="r-fit-text">–ü–æ—Å—Ç–∞–≤–∏–º Postgres –∏–∑ –∏—Å—Ö–æ–¥–Ω–∏–∫–æ–≤</h1>
                <img src="images/mem12.jpg" alt="">
            </section>
            <section>
                <p>–ü–µ—Ä–µ–ø–∏—à–µ–º —á—É—Ç—å –º–µ—Ç–æ–¥ read</p>
                <pre><code data-line-numbers="" data-trim data-noescape style="font-size: 15px;">
                    def read(self, path, length, offset, fh):
                        print(path, length, offset, fh)
                        if re.match(r'/installed_postgres/data/.*', path) and random.random() < 0.5:
                            return b''  # Return an empty byte string as a no-op
                        else:
                            os.lseek(fh, offset, os.SEEK_SET)
                            return os.read(fh, length)
                </code></pre>
            </section>
            <section>
                <h1 class="r-fit-text">Postgres —Ä–∞–±–æ—Ç–∞–µ—Ç</h1>
                <img src="images/postgress-install-success.png" alt="">
            </section>
            <section>
                <p>–ó–∞–ø—É—Å–∫–∞–µ–º —Ñ–∞–π–ª–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É</p>
                <p>–ü–æ—Å—Ç–≥—Ä–µ—Å—É –ø–æ—Ñ–∏–≥ :C</p>
                <img src="images/pofig.png" alt="">
            </section>
            <section>
                <p>–¢.–µ —è –ø—Ä–æ–≤–µ–ª —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç<br>
                    —Å–¥–µ–ª–∞–ª write –≤–Ω—É—Ç—Ä–∏ basedir –Ω–µ –ª–æ–≥–∏—Ä—É–µ—Ç
                    —Å–¥–µ–ª–∞–ª write —Ç–æ–≥–æ –∂–µ —Ñ–∞–π–ª–∞ –≤–Ω—É—Ç—Ä–∏ mntdir - –ª–æ–≥–∏—Ä—É–µ—Ç
                    –í–æ–∑–Ω–∏–∫–∞–µ—Ç –≤–æ–ø—Ä–æ—Å –∫–∞–∫ –∑–∞—Å—Ç–∞–≤–∏—Ç—å postgres –¥–µ–ª–∞—Ç—å —ç—Ç–æ —á–µ—Ä–µ–∑ mntdir?</p>
            </section>
            <section>
                <p>–°–∞–º —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç</p>
                <pre><code data-line-numbers="" data-trim data-noescape style="font-size: 15px;">
                    $ echo "test str" > data/example.txt
                    $ echo "test str 2" > mntpoint/example.txt 
                </code></pre>
                <p>–õ–æ–≥–∏ —Ñ–∞–π–ª—É—Ö–∏:</p>
                <pre><code data-line-numbers="" data-trim data-noescape style="font-size: 15px;">
                    $ python3 fs2.py data mntpoint            
                    /example.txt b'test str 2\n' 0 4
                </code></pre>
                <p>–ü–æ–Ω—è–ª —á—Ç–æ–±—ã –≤—Å–µ –∑–∞—Ä–∞–±–æ—Ç–∞–ª–æ –Ω–∞–¥–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é pgdata –∏–º–µ–Ω–Ω–æ –≤–Ω—É—Ç—Ä–∏ mntpoint –∏ –Ω–∞ –Ω–µ–µ –∑–∞–ø—É—Å–∫–∞—Ç—å pginit</p>
            </section>
            <section>
                <p>–õ–æ–≥–∏ –æ—Ç Postgres –ø–æ–ª–µ—Ç–µ–ª–∏ )</p>
                <img src="images/fun-big-logs.jpg" alt="">
            </section>
            <section>
                <p>–ù–µ –≤—Å—Ç–∞–≤–∏–ª–æ—Å—å ((</p>
                <img src="images/not-inserted.jpg" alt="">
            </section>
        </div>
    </div>
    <script src="dist/reveal.js"></script>
    <script src="plugin/notes/notes.js"></script>
    <script src="plugin/markdown/markdown.js"></script>
    <script src="plugin/highlight/highlight.js"></script>
    <script>
    Reveal.initialize({
        slideNumber: true,
        hash: true,
        plugins: [RevealMarkdown, RevealHighlight, RevealNotes]
    });
    </script>
</body>

</html>